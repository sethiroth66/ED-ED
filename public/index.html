<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EDJR - Elite Dangerous Journal Reader</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="/vue.js"></script>
</head>
<body id="EDJR">

    <div v-if="system.name.length" id="targetSystem">
        <h2>Target System:</h2>
        <h3 class="systemName">{{system.system_name}}</h3>
        <div v-bind:class="{'scoopable': scoopable}" class="starClass">{{system.star_class}}</div>
    </div>

    <div id="currentSystem" class="">
        <h2>Current System:</h2>
        <h3 class="systemName">{{system.system_name}}</h3>
        <div class="starClass">{{system.star_class}}</div>
        <div class="systemDiscovered">Discovered already?</div>
        <div class="systemDiscovered">{{system.was_discovered}}</div>
        <progress id="systemScanProgress" max="1" :value="system.scan_progress"></progress>
        
        <div v-if="system.bodies.length" id="bodies" class="cards">
            <div v-for="body in system.bodies" v-bind:class="{ 'faded':body.was_discovered }" class="card elementStyle">
                <div class="card_header">
                    <h3 class="body_name">{{body.name}}</h3>
                </div>
                <div class="card_body">
                    <div class="row2">
                        <div>Discovered</div>
                        <div>{{ body.was_discovered }}</div>
                    </div>
                    <div class="row2">
                        <div>mapped</div>
                        <div>{{ body.was_mapped }}</div>
                    </div>
                </div>
            </div>
        </div>
        
    </div>

</body>
<script type="text/javascript">
  let EDJR = {
    currentSystem: {},
    targetSystem:{}
  };

  let currentSystem = new Vue({
    el: '#currentSystem',
    data: {system:EDJR.currentSystem}
  })
  let targetSystem = new Vue({
    el: '#targetSystem',
    data: {system:EDJR.targetSystem}
  })

  var socket = io();
  socket.on("message", function (d, a) {
    if (d.action === "update") {
      currentSystem._data.system = d.EDJRData.currentSystem;
      targetSystem._data.system = d.EDJRData.targetSystem;
    }
    else if (d.action === "updateCurrent") {
      currentSystem._data.system = d.EDJRData;
    }
    else if (d.action === "updateTarget") {
      targetSystem._data.system = d.EDJRData;
    }
  })
</script>
</html>
