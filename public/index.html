<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>EDJR - Elite Dangerous Journal Reader</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="/socket.io/socket.io.js"></script>
    <script src="/vue.js"></script>
</head>
<body id="EDJR">

<div v-if="system.system_name && system.system_name.length && system.system_name !== '...'" id="targetSystem">
    <h2>Target System:</h2>
    <h3 class="systemName">{{system.system_name}}</h3>
    <div v-bind:class="{'scoopable': system.scoopable}" class="starClass">{{system.star_class}}</div>
</div>

<div id="currentSystem" class="">
    
    <div class="grid">
        <h2 class="grid_1_3">Current System:</h2>
        <h3 class="grid_1_2 systemName">{{system.system_name}}</h3>
        <h3 class="grid_2_3 starClass" v-bind:class="{'scoopable': system.scoopable}">{{system.star_class}}</h3>
<!--    <div class="systemDiscovered">Discovered already?</div>-->
<!--    <div class="systemDiscovered">{{system.was_discovered}}</div>-->
        <progress class="grid_1_3" id="systemScanProgress" max="1" :value="system.scan_progress"></progress>
    </div>

    <div v-if="system.bodies" id="bodies" class="cards grid">
        <div class="card grid elementStyle" v-for="body in system.bodies" v-bind:class="{ 'faded':body.was_discovered, 'important':body.important }">
            <div class="grid_1_3">
                <h3 class="body_name">{{body.body_name}}</h3>
            </div>
            <div class="grid grid_1_3">
                <div>Discovered</div>
                <div>{{ body.was_discovered }}</div>
            </div>
            <div class="grid grid_1_3">
                <div>mapped</div>
                <div>{{ body.was_mapped }}</div>
            </div>
            
        </div>
    </div>

</div>

</body>
<script type="text/javascript">
  let EDJR = {
    currentSystem: {system: {}},
    targetSystem: {system: {}}
  };

  let currentSystem = new Vue({
    el: '#currentSystem',
    name: 'CurrentSystem',
    data: EDJR.currentSystem
  })
  let targetSystem = new Vue({
    el: '#targetSystem',
    name: 'TargetSystem',
    data: EDJR.targetSystem
  })
  var socket = io();
  socket.on("message", function (d, a) {
    if (d.action === "update") {
      EDJR.currentSystem.system = d.EDJRData.currentSystem;
      EDJR.targetSystem.system = d.EDJRData.targetSystem;
    } else if (d.action === "updateCurrent") {
      EDJR.currentSystem.system = d.EDJRData;
    } else if (d.action === "updateTarget") {
      EDJR.targetSystem.system = d.EDJRData;
    }
  })

</script>
</html>
